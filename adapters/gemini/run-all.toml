description = "Full PRP workflow — plan, implement, commit, PR, review. Supports --plan-path, --skip-review, --no-pr"
prompt = """# PRP Run All — Full Workflow

Input: {{args}}

## Step 0: Parse Input

| Argument | Action |
|----------|--------|
| `--plan-path <path>` | Set PLAN_PATH. Skip Step 2. |
| `--skip-review` | Skip Step 6. |
| `--no-pr` | Skip Steps 5 and 6. |
| Remaining text | Set FEATURE |

Variables: FEATURE, PLAN_PATH (TBD), BRANCH (TBD), PR_NUMBER (TBD), SKIP_REVIEW, NO_PR

Examples: `Add JWT auth` → full, `--plan-path plans/jwt.plan.md` → skip plan, `Add JWT auth --skip-review` → skip review, `--plan-path plans/jwt.plan.md --no-pr` → implement + commit only

## Workflow (sequential, stop on failure)

### Step 1: Branch
`git checkout -b feature/{slug}` (skip if already on feature branch). Dirty on main → STOP.

### Step 2: Plan (skip if --plan-path)
Run /prp:plan with FEATURE. Update PLAN_PATH. Failure → STOP.
❌ DO NOT: Inline plan logic, analyze codebase yourself. ✅ CHECKPOINT: Did you run /prp:plan?

### Step 3: Implement
Run /prp:implement with PLAN_PATH. Wait for completion. Failure → STOP.
❌ DO NOT: Inline implement logic, write code yourself. ✅ CHECKPOINT: Did you run /prp:implement?

**3.1 Verify Artifacts**: Check report and pr-context files exist after implement completes.
**3.2 Fallback**: If missing, create minimal report/context with files changed from git diff.

### Step 4: Commit
Run /prp:commit. ❌ DO NOT: Run git add/commit directly. ✅ CHECKPOINT: Did you run /prp:commit?

### Step 5: PR (skip if --no-pr)
Run /prp:pr. Update PR_NUMBER. Failure → STOP.
❌ DO NOT: Run gh pr create directly. ✅ CHECKPOINT: Did you run /prp:pr?

### Step 6: Review (skip if --skip-review or --no-pr)
Run /prp:review with PR_NUMBER. Critical issues → fix, commit, push, re-review (max 2 cycles).
❌ DO NOT: Review code yourself. ✅ CHECKPOINT: Did you run /prp:review?

### Step 7: Summary
Report: feature, branch, status, steps executed, artifacts, verdict, next steps.

## Rules

- Delegate, don't duplicate — each command handles its own logic
- Verify artifacts after implement — check report and pr-context exist, fallback if missing
- Stop on failure — never continue with broken state
- Pass context forward — info flows from earlier to later steps
- No extra validation — each command validates its own output
- One commit per implementation — separate commits for review fixes
- Max 2 review-fix cycles

## Success Criteria

- Plan created (or provided)
- Code implemented with passing validation
- Report exists (created or fallback)
- Review context exists (created or fallback)
- Committed, PR created (unless --no-pr), reviewed (unless --skip-review)
"""
